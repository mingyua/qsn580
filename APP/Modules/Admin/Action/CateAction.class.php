<?php	class CateAction extends CommonAction{	//分类列表    public function index(){		import('Class.Cate',APP_PATH);		$cate=M('cate')->order('sort ASC')->select();		 $this->cate=Cate::unlimitedForlevel($cate,'&nbsp;&nbsp;┗━');		$this->display();    }    public function addcate(){		$this->parentid=I('parentid',0);		$this->pid=I('pid',0,'intval');		$this->id=I('id',0,'intval');		$id=$_GET['id'];		$cate = M("Cate"); // 实例化User对象		$list=$cate->where("id=$id")->find();		$this->assign('list',$list);		$this->display();    }	//添加分类    public function runaddcate(){			$cate=new Model('cate');			$data=array();			$data['id']=$_POST['id'];			$data['name']=$_POST['name'];			$data['sort']=$_POST['sort'];			$data['module']=$_POST['module'];			$data['parentid']=$_POST['parentid'];			if($data['module']=="Article"){				$url="acate";				}else				if($data['module']=="Product"){				$url="pcate";				}else				if($data['module']=="Slide"){				$url="scate";				}else				if($data['module']=="Ad"){				$url="adcate";				}else{				$url="index";					}			if($_POST['id']<>0){			$count=$cate->save($data);			if($count !==false){				$this->success('分类修改成功！',U(GROUP_NAME.'/Cate/'.$url));			}else{				$this->error('分类修改失败');					}			}else{		if(M('cate')->add($_POST)){			$this->SUCCESS('添加成功',U(GROUP_NAME.'/Cate/'.$url));					}else{			$this->error('添加失败');					}			}    }    public function delete(){	$module=$_GET['module'];			if($module=="Article"){				$url="acate";				}else				if($module=="Product"){				$url="pcate";				}else				if($module=="Slide"){				$url="scate";				}else				if($module=="Ad"){				$url="adcate";				}else{				$url="index";					}	$id=$_GET['id'];	$cate = M("Cate"); // 实例化User对象	if($cate->where("id=$id")->delete()){					$this->success('分类删除成功!',U(GROUP_NAME.'/Cate/'.$url));				}else{					$this->error('分类删除失败!');				}	    }	//排序    public function sortcate(){	$db=M('cate');	foreach ($_POST as $id => $sort){	$db->where(array('id'=>$id))->setField('sort',$sort);	}	$this->redirect(GROUP_NAME.'/Cate/index');    }			//产品类页面		Public function Pcate(){		import('Class.Cate',APP_PATH);		$cate=M('cate')->where("module='Product'")->order('sort ASC')->select();		 $this->cate=Cate::unlimitedForlevel($cate,'&nbsp;&nbsp;┗━');		$this->display(index);		}	//产品添加分类页面		Public function Paddcate(){		$this->module="Product";		$this->parentid=I('parentid',0);		$this->pid=I('pid',0,'intval');		$this->id=I('id',0,'intval');		$id=$_GET['id'];		$cate = M("Cate"); // 实例化User对象		$list=$cate->where("id=$id")->find();		$this->assign('list',$list);		$this->display(addcate);		}		//幻灯片类页面		Public function Scate(){		import('Class.Cate',APP_PATH);		$cate=M('cate')->where("module='Slide'")->order('sort ASC')->select();		 $this->cate=Cate::unlimitedForlevel($cate,'&nbsp;&nbsp;┗━');		$this->display(index);		}	//幻灯片添加分类页面		Public function Saddcate(){		$this->module="Slide";		$this->parentid=I('parentid',0);		$this->pid=I('pid',0,'intval');		$this->id=I('id',0,'intval');		$id=$_GET['id'];		$cate = M("Cate"); // 实例化User对象		$list=$cate->where("id=$id")->find();		$this->assign('list',$list);		$this->display(addcate);		}		//广告类页面		Public function Adcate(){		import('Class.Cate',APP_PATH);		$cate=M('cate')->where("module='Ad'")->order('sort ASC')->select();		 $this->cate=Cate::unlimitedForlevel($cate,'&nbsp;&nbsp;┗━');		$this->display(index);		}	//广告添加分类页面		Public function Adaddcate(){		$this->module="Ad";		$this->parentid=I('parentid',0);		$this->pid=I('pid',0,'intval');		$this->id=I('id',0,'intval');		$id=$_GET['id'];		$cate = M("Cate"); // 实例化User对象		$list=$cate->where("id=$id")->find();		$this->assign('list',$list);		$this->display(addcate);		}	}