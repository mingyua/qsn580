<?phpClass EmailAction extends CommonAction{	//邮件配置页面		Public function index(){		$email=M('email')->find();		$this->user=M('user')->select();		$this->assign('email',$email);		$this->display();				}	Public function edit(){						$save=M('email')->save($_POST);			if($save){				$this->error('保存成功！');				}else{								$this->error('保存失败！');				}		}	//测试发送		Public function sendmail(){		$v=M('email')->find();		$title=$_POST['title'];		$address=explode(',',$_POST['address']);		$contents=$_POST['contents'];		//echo $title.$address.$contents;		ini_set("magic_quotes_runtime",0);		require './ThinkPHP/Extend/Library/Org/Nx/class.phpmailer.php';		foreach($address as $k){			try {				$mail = new PHPMailer(true); 				$mail->IsSMTP();				$mail->CharSet= $v['charset']; //设置邮件的字符编码，这很重要，不然中文乱码				$mail->SMTPAuth   =  $v['host'];                  //开启认证				$mail->Port       =  $v['port'];                    				$mail->Host       = $v['host']; 				$mail->Username   =  $v['username'];    				$mail->Password   =  $v['password'];            				//$mail->IsSendmail(); //如果没有sendmail组件就注释掉，否则出现“Could  not execute: /var/qmail/bin/sendmail ”的错误提示				$mail->AddReplyTo( $v['addreplyto'], $v['addname']);//回复地址				$mail->From       =  $v['addreplyto'];				$mail->FromName   =  $v['fromname'];				$to =$k;				$mail->AddAddress($to);				$mail->Subject  = $title;				$mail->Body = $contents;				$mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; //当邮件不支持html时备用显示，可以省略				$mail->WordWrap   = 80; // 设置每行字符串的长度				//$mail->AddAttachment("f:/test.png");  //可以添加附件				$mail->IsHTML(true); 				$mail->Send();				echo $k."邮件发送成功!<br>";			} catch (phpmailerException $e) {				echo $k."邮件发送失败：".$e->errorMessage()."<br>";			}		}	}		}