<?phpClass IndexAction extends CommonAction{	Public function index(){		$slide=M('slide')->where('id=44')->find();		$slides=explode('|',$slide['pic']);		$about=M('single')->where('kinds=2')->find();		//nav		import('Class.Cate',APP_PATH);		$nav=M('cate')->where("nav='1'")->order('sort ASC')->select();		$this->nav=Cate::navtree($nav,'child','0');				//环境		$evment=M('article')->where('kinds=3 AND hots=1')->order('id DESC')->limit(20)->select();		foreach($evment as $k=>$v){			$evment[$k]['pic']=imgpath($v['pic'],'1');			$evment[$k]['contents']=imgpath($v['contents'],'2');		}			//课程		$cate=M('cate')->alias('c')->where('c.pid=12 and c.nav=1')->field('c.id,c.name')->order('sort DESC')->limit(8)->select();				$map['hots']=array('eq',1);		foreach($cate as $k=>$v){			$map['kinds']=array('eq',$v['id']);			$pic=M('article')->where($map)->field('pic')->order('id desc')->limit(1)->find();			if($pic){				if(empty($pic['pic'])){					$cate[$k]['pic']=imgpath('',1);				}else{					$cate[$k]['pic']=imgpath($pic['pic'],'1');				}							}else{				$cate[$k]['pic']=imgpath('',1);			}		}				$case1=M('article')->where("kinds in('20,21')  AND hots=1")->order('id desc')->limit(3)->select();		foreach($case1 as $k=>$v){			$case1[$k]['pic']=imgpath($v['pic'],'1');		}		$case2=M('article')->where("kinds='22'  AND hots=1")->order('id desc')->limit(3)->select();		foreach($case2 as $k=>$v){			$case2[$k]['pic']=imgpath($v['pic'],'1');		}		$case3=M('article')->where("kinds='19'  AND hots=1")->order('id desc')->limit(3)->select();		foreach($case3 as $k=>$v){			$case3[$k]['pic']=imgpath($v['pic'],'1');		}		$case4=M('article')->where("kinds='41'  AND hots=1")->order('id desc')->limit(3)->select();		foreach($case4 as $k=>$v){			$case4[$k]['pic']=imgpath($v['pic'],'1');		}					$team=M('article')->where("kinds='5'  AND hots=1")->order('id desc')->limit(20)->select();		foreach($team as $k=>$v){			$team[$k]['pic']=imgpath($v['pic'],'1');		}				$news=M('article')->where("kinds in('24,25,26,27,29')  AND hots=1")->order('id desc')->limit(6)->select();		$wx=M('link')->where("id=64")->find();		
		$qq=M('qq')->where("id=1")->find();		$this->slist=$slides;		$this->about=$about;		$this->evment=$evment;		$this->course=$cate;		$this->case1=$case1;		$this->case2=$case2;		$this->case3=$case3;		$this->case4=$case4;		$this->team=$team;		$this->news=$news;		$this->wx=imgpath($wx['image'],3);
		$this->wxname=$wx['name'];		$this->qq=explode(',',$qq['qq']);		$this->display();	}	Public function about(){		$id=I('get.id',10);		$info=M('single')->where("id='$id'")->find();		$info['contents']=imgpath($info['contents'],2);				$this->info=$info;		$this->display();	}	Public function cases(){		import('Class.Pages',APP_PATH);		$kinds=I('get.kinds',20);		$cate=M('cate')->where("id='$kinds'")->find();		$title=$cate['name'];		$m=M('article');		$where="kinds='$kinds'";		$p=getpage($m,$where,10);		$info=$m->field(true)->where($where)->order('id desc')->select();		foreach($info as $k=>$v){						$info[$k]['pic']=imgpath($v['pic'],'1');			$info[$k]['contents']=imgpath($info['contents'],2);		}		$catelist=M('cate')->where("pid='18' and nav=1")->select();		$this->title=$title;		$this->info=$info;		$this->page=$p->show();			$this->catelist=$catelist;		$this->kinds=$kinds;						$this->display();	}	Public function contact(){		$kinds=I('get.id',65);		$info=M('single')->where("kinds='$kinds'")->find();		$info['contents']=imgpath($info['contents'],2);		$this->info=$info;		$this->display();	}	Public function course(){		import('Class.Pages',APP_PATH);		$kinds=I('get.kinds',60);		$cate=M('cate')->where("id='$kinds'")->find();		$title=$cate['name'];		$m=M('article');		$where="kinds='$kinds'";		$p=getpage($m,$where,10);		$p->setConfig('prev','上一页');	    $p->setConfig('next','下一页');		$info=$m->field(true)->where($where)->order('id desc')->select();		foreach($info as $k=>$v){						$info[$k]['pic']=imgpath($v['pic'],'1');			$info[$k]['contents']=imgpath($info['contents'],2);		}		$catelist=M('cate')->where("pid='12' and nav=1")->select();		$this->title=$title;		$this->info=$info;		$this->page=$p->show();			$this->catelist=$catelist;		$this->kinds=$kinds;		$this->display();	}	Public function team(){		import('Class.Pages',APP_PATH);		$kinds=I('get.kinds',5);		$cate=M('cate')->where("id='$kinds'")->find();		$title=$cate['name'];		$m=M('article');		$where="kinds='$kinds'";		$p=getpage($m,$where,10);		$p->setConfig('prev','上一页');	    $p->setConfig('next','下一页');		$info=$m->field(true)->where($where)->order('id desc')->select();		foreach($info as $k=>$v){						$info[$k]['pic']=imgpath($v['pic'],'1');			$info[$k]['contents']=imgpath($info['contents'],2);		}		$this->title=$title;		$this->info=$info;		$this->page=$p->show();			$this->kinds=$kinds;		$this->display();	}	Public function news(){		import('Class.Pages',APP_PATH);		$kinds=I('get.kinds',24);		$cate=M('cate')->where("id='$kinds'")->find();		$title=$cate['name'];		$m=M('article');		$where="kinds='$kinds'";		$p=getpage($m,$where,16);		$p->setConfig('prev','上一页');	    $p->setConfig('next','下一页');		$info=$m->field(true)->where($where)->order('id desc')->select();		foreach($info as $k=>$v){						$info[$k]['pic']=imgpath($v['pic'],'1');			$info[$k]['contents']=imgpath($info['contents'],2);		}		$catelist=M('cate')->where("pid='23' and nav=1")->select();		$this->title=$title;		$this->info=$info;		$this->page=$p->show();			$this->catelist=$catelist;		$this->kinds=$kinds;		$this->display();	}	Public function show(){		$id=I('get.id',0);		$kinds=I('get.id',0);		if($id>0){			$info=M('article')->where("id='$id'")->find();			$info['contents']=imgpath($info['contents'],2);		}		$this->info=$info;		$this->display();	} Public function test(){ 	$this->display(); }}?>